var KEYCODE_ESC = 27;
function jumpMenu(targ, selObj, restore) {
  (eval(
    targ + ".location='" + selObj.options[selObj.selectedIndex].value + "'",
  ),
    restore && (selObj.selectedIndex = 0));
}
function checkAvailability() {
  jQuery.ajax({
    url: username_url,
    data: "user_name=" + $("#user_name").val(),
    type: "POST",
    success: function (e) {
      $("#username-status").html(e);
    },
    error: function () {},
  });
}
function AjaxFunction(e) {
  try {
    o = new XMLHttpRequest();
  } catch (t) {
    try {
      o = new ActiveXObject("Msxml2.XMLHTTP");
    } catch (a) {
      try {
        o = new ActiveXObject("Microsoft.XMLHTTP");
      } catch (s) {
        return !1;
      }
    }
  }
  var o,
    i = email_url;
  ((i = (i = i + "?email=" + e) + "&sid=" + Math.random()),
    (o.onreadystatechange = function () {
      4 == o.readyState &&
        (document.getElementById("msg_email").innerHTML = o.responseText);
    }),
    o.open("GET", i, !0),
    o.send(null));
}
function EmailAjaxFunction(e) {
  var t;
  try {
    t = new XMLHttpRequest();
  } catch (a) {
    try {
      t = new ActiveXObject("Msxml2.XMLHTTP");
    } catch (s) {
      try {
        t = new ActiveXObject("Microsoft.XMLHTTP");
      } catch (o) {
        return !1;
      }
    }
  }
}
function stateck() {
  (4 == httpxml.readyState &&
    (document.getElementById("msg_email").innerHTML = httpxml.responseText),
    (email_url =
      (email_url =
        1 == setup
          ? email_url + "?section=setup&email=" + email
          : email_url + "?email=" + email) +
      "&sid=" +
      Math.random()),
    (httpxml.onreadystatechange = stateck),
    httpxml.open("GET", email_url, !0),
    httpxml.send(null));
}
function formatTimeDisplay(e, t) {
  if ("" == t) var a = 0;
  else var a = t;
  var s = parseInt((((e % 31536e3) % 86400) % 3600) % 60, 10);
  if (0 == a)
    var o = parseInt(Math.floor(((e % 31536e3) % 86400) / 3600), 10),
      i = parseInt(Math.floor((((e % 31536e3) % 86400) % 3600) / 60), 10),
      n =
        (o < 10 ? "0" + o : o) +
        ":" +
        (i < 10 ? "0" + i : i) +
        ":" +
        (s < 10 ? "0" + s : s);
  if (1 == a)
    var i = parseInt(Math.floor((((e % 31536e3) % 86400) % 3600) / 60), 10),
      n = (i < 10 ? "0" + i : i) + ":" + (s < 10 ? "0" + s : s);
  if (2 == a) var n = s < 10 ? "0" + s : s;
  return n;
}
function fetchRecordCount(e, t, a, s, o, i, n, r, l, c) {
  ((element_updated = (t = (prefix = 1 == a ? "." : "#") + t) + "-updated"),
    (count_url = e + "count_records.ajax.php?section=" + s),
    void 0 !== o &&
      void 0 !== i &&
      (count_url = count_url + "&p1=" + o + "&c1=" + i),
    void 0 !== n &&
      void 0 !== r &&
      (count_url = count_url + "&p2=" + n + "&c2=" + r),
    void 0 !== l &&
      void 0 !== c &&
      (count_url = count_url + "&p3=" + l + "&c3=" + c),
    $.ajax({
      url: count_url,
      type: "GET",
      dataType: "json",
      success: function (e) {
        e.success
          ? ($(t).html(e.count), $(element_updated).html(e.updated))
          : ($(t).text("Error"),
            $(element_updated).text("Failed to fetch data: " + e.message));
      },
      error: function (e, a, s) {
        ($(t).text("Error"),
          $(element_updated).text("Connection failed: " + s));
      },
    }));
}
function reveal() {
  for (
    var e = document.querySelectorAll(".reveal-element"), t = 0;
    t < e.length;
    t += 1
  ) {
    var a = window.innerHeight;
    e[t].getBoundingClientRect().top < a - 225
      ? e[t].classList.add("active-element")
      : e[t].classList.remove("active-element");
  }
}
function change_email_ajax_results() {
  if (Array.isArray(ajax_result) && ajax_result.length) {
    var e = JSON.parse(ajax_result);
    0 == e.user_name_found
      ? ($("#change-email-avail-status").show(),
        $("#change-email-submit").prop("disabled", !1),
        $("#change-email-avail-status").html(email_not_in_use))
      : 2 == e.user_name_found
        ? ($("#change-email-avail-status").show(),
          $("#change-email-submit").prop("disabled", !0),
          $("#change-email-sure").prop("checked", !1),
          $("#change-email-avail-status").html(email_not_valid))
        : ($("#change-email-avail-status").show(),
          $("#change-email-submit").prop("disabled", !0),
          $("#change-email-sure").prop("checked", !1),
          $("#change-email-avail-status").html(email_in_use));
  }
}
function check_user_name_avail(e, t, a, s) {
  var t = "#" + t,
    a = "#" + a,
    o = "";
  if ("forgot_password" == s) var o = "&go=forgot";
  if ("change_email" == s) var o = "&go=change";
  jQuery.ajax({
    url: e + "account_checks.ajax.php?action=username" + o,
    data: "user_name=" + $(t).val(),
    type: "POST",
    success: function (e) {
      "change_email" == s
        ? ((ajax_result.length = 0),
          ajax_result.push(e),
          change_email_ajax_results())
        : ($(a).html(e), $("#forgot-user-name-check-button").hide());
    },
    error: function () {},
  });
}
function check_security_question_answer(e, t, a) {
  var t = "#" + t,
    a = "#" + a;
  jQuery.ajax({
    url: e + "account_checks.ajax.php?action=check_answer",
    data: "user_question_answer=" + $(t).val(),
    type: "POST",
    success: function (e) {
      $(a).html(e);
    },
    error: function () {},
  });
}
($(document).keyup(function (e) {
  e.which == KEYCODE_ESC && $("#loader-submit").stop();
}),
  $(function () {
    $('[data-toggle="tooltip"]').tooltip();
  }),
  $(function () {
    $('[data-tooltip="true"]').tooltip();
  }),
  $(function () {
    $('[data-toggle="popover"]').popover();
  }),
  window.addEventListener("scroll", reveal, { passive: !0 }),
  Array.from(document.querySelectorAll(".needs-validation")).forEach((e) => {
    e.addEventListener(
      "submit",
      (t) => {
        (e.checkValidity()
          ? (document.getElementById("loader-submit").style.display = "block")
          : ((document.getElementById("loader-submit").style.display = "none"),
            t.preventDefault(),
            t.stopPropagation(),
            $("#form-submit-button-disabled-msg-required").modal("show")),
          e.classList.add("was-validated"));
      },
      !1,
    );
  }));
let checkEmailTimer = null,
  checkEmailRequest = null;
function check_valid_email(e, t, a) {
  (checkEmailTimer && clearTimeout(checkEmailTimer),
    (checkEmailTimer = setTimeout(function () {
      let s = "#" + a,
        o = jQuery("#" + t).val();
      (checkEmailRequest &&
        4 !== checkEmailRequest.readyState &&
        checkEmailRequest.abort(),
        (checkEmailRequest = jQuery.ajax({
          url: e + "account_checks.ajax.php?action=email",
          type: "POST",
          data: { email: o },
          success: function (e) {
            jQuery(s).html(e);
          },
          error: function (e, t) {},
        })));
    }, 600)));
}
function clear_all_form_fields(e) {
  var e = "#" + e;
  $(e)[0].reset();
}
function clear_form_field(e) {
  var e = "#" + e;
  ($(e).val(""), $(e).val([]));
}
function forgot_password_hide_elements() {
  ($("#forgot-user-name-check-button").prop("disabled", !0),
    $("#forgot-password-security-question-button").prop("disabled", !0),
    $("#forgot-user-name-status").empty().hide(),
    $("#forgot-user-name-email-status").empty().hide(),
    $("#forgot-user-name-clear-button").hide(),
    $("#forgot-user-name-check-button").hide(),
    $("#security-question-response-status").empty().hide());
}
function forgot_password_clear_all() {
  (forgot_password_hide_elements(),
    clear_form_field("forgot-password-security-question"),
    clear_form_field("forgot-user-name"));
}
function checkFieldsMatch() {
  var e = $("#password-entry").val(),
    t = $("#password-confirm").val(),
    a = !1;
  (e.length > 0 && t.length > 0
    ? e === t
      ? ((a = !0), $("#password-error").hide())
      : $("#password-error").show()
    : $("#password-error").hide(),
    a
      ? $("#submit-button").prop("disabled", !1)
      : $("#submit-button").prop("disabled", !0));
}
function initCollapseStateManager(e) {
  let t = document.getElementById(e.collapseElementId);
  document.getElementById(e.toggleButtonId);
  let a = document.getElementById(e.toggleIconId),
    s = `collapse_state_${e.collapseElementId}`,
    o = getSessionCookie(s);
  ("collapsed" === o
    ? ($(t).collapse("hide"),
      a.classList.remove(e.iconClassExpanded),
      a.classList.add(e.iconClassCollapsed))
    : "expanded" === o &&
      ($(t).collapse("show"),
      a.classList.remove(e.iconClassCollapsed),
      a.classList.add(e.iconClassExpanded)),
    $(t).on("hidden.bs.collapse", function () {
      (setSessionCookie(s, "collapsed"),
        a.classList.remove(e.iconClassExpanded),
        a.classList.add(e.iconClassCollapsed));
    }),
    $(t).on("shown.bs.collapse", function () {
      (setSessionCookie(s, "expanded"),
        a.classList.remove(e.iconClassCollapsed),
        a.classList.add(e.iconClassExpanded));
    }));
}
function setSessionCookie(e, t) {
  document.cookie = `${e}=${t}; path=/; SameSite=Strict`;
}
function getSessionCookie(e) {
  let t = document.cookie.split(";");
  for (let a = 0; a < t.length; a += 1) {
    let s = t[a].split("=");
    if (s[0].trim() === e) return s[1];
  }
  return null;
}
(setTimeout(function () {
  $(".alert-stacked")
    .css("opacity", 1)
    .slideUp("fast")
    .animate({ opacity: 0 }, { queue: !1, duration: "fast" })
    .removeClass("show");
}, 15e3),
  setTimeout(function () {
    ($("#alert-auto-dismiss").fadeOut("fast"),
      $("#alert-auto-dismiss").removeClass("show"));
  }, 1e4),
  $(document).ready(function () {
    ($(".no-spam").bind("cut copy paste", function (e) {
      e.preventDefault();
    }),
      $(".no-spam").bind("contextmenu", function (e) {
        e.preventDefault();
      }),
      $("#submitBtn").click(function () {
        $("#archiveName").html($("#archiveSuffix").val());
      }),
      $("#submit").click(function () {
        $("#formfield").submit();
      }),
      $("#admin-arrow").click(function () {
        ($(this)
          .find("i")
          .toggleClass("fa-chevron-circle-left fa-chevron-circle-right"),
          $(this).find("i").toggleClass("text-teal text-orange"));
      }),
      $(".my-dropdown").dropdown(),
      $(".my-dropdown").tooltip(),
      $("a:not([href*='#'],[target='_blank'])").click(function () {
        $(this).hasClass("hide-loader")
          ? $("#loader-submit").hide()
          : $("#loader-submit").show(0).delay(3e4).hide(0);
      }),
      $("a[target='_blank']").click(function () {
        $(this).hasClass("hide-loader") && $("#loader-submit").hide();
      }),
      $(".hide-loader").click(function () {
        $("#loader-submit").hide();
      }),
      $(".modal-window-link").click(function () {
        $("#loader-submit").hide();
      }),
      $("form").submit(function () {
        $(this).hasClass("hide-loader-form-submit")
          ? $("#loader-submit").hide()
          : $("#loader-submit").show(0).delay(3e4).hide(0);
      }),
      $("#form-submit-button-disabled-msg-required").hide(),
      $("#form-submit-button").click(function () {
        $(this).is(":disabled") || $(this).hasClass("disabled")
          ? ($("#submit-form").removeClass("hide-loader-form-submit"),
            $("#submit-form").addClass("hide-loader-form-submit"),
            $("#form-submit-button-disabled-msg-required").fadeIn())
          : ($("#submit-form").removeClass("hide-loader-form-submit"),
            $("#form-submit-button-disabled-msg-required").fadeOut());
      }),
      $(".modal-window-link").fancybox({
        toolbar: !1,
        smallBtn: !0,
        buttons: ["close"],
        iframe: { attr: { scrolling: "auto" }, preload: !0 },
      }),
      $('[data-fancybox="gallery"]').fancybox({
        buttons: [
          "slideShow",
          "thumbs",
          "zoom",
          "fullScreen",
          "share",
          "close",
        ],
        loop: !0,
        protect: !0,
      }),
      $("a[data-confirm]").click(function (e) {
        return (
          e.preventDefault(),
          $("#dataConfirmModal").length ||
            $("body").append(
              '<div class="modal fade" id="dataConfirmModal" tabindex="-1" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h4 class="modal-title"></h4><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"></div><div class="modal-footer"><button type="button" class="btn btn-danger" data-bs-dismiss="modal" id="dataConfirmCancel"></button><a class="btn btn-primary" id="dataConfirmOK"></a></div></div></div></div>',
            ),
          $("#dataConfirmModal")
            .find(".modal-body")
            .text($(this).attr("data-confirm")),
          $("#dataConfirmModal")
            .find(".modal-title")
            .text($(this).attr("data-confirm-title")),
          $("#dataConfirmCancel").text($(this).attr("data-confirm-cancel")),
          $("#dataConfirmOK").attr("href", $(this).attr("href")),
          $("#dataConfirmOK").text($(this).attr("data-confirm-proceed")),
          $("#dataConfirmModal").modal("show"),
          !1
        );
      }),
      $("#forgot-user-name-check-button").prop("disabled", !0),
      $("#forgot-user-name-clear-button").hide(),
      $("#forgot-user-name-check-button").hide(),
      $("#forgot-user-name-status").hide(),
      $("#forgot-user-name-email-status").hide(),
      $("#security-question-response-status").hide(),
      $("#forgot-user-name").keyup(function (e) {
        ("" != $("#forgot-user-name").val() &&
          ($("#forgot-user-name-check-button").prop("disabled", !1),
          $("#forgot-user-name-status").show(),
          $("#forgot-user-name-email-status").show(),
          $("#forgot-user-name-clear-button").show("fast"),
          $("#forgot-user-name-check-button").show("fast"),
          13 == e.which &&
            check_user_name_avail(
              ajax_url,
              "forgot-user-name",
              "forgot-user-name-status",
              "forgot_password",
            )),
          "" == $("#forgot-user-name").val() &&
            forgot_password_hide_elements());
      }),
      $("#forgot-user-name-status").keyup(function (e) {
        ("" != $("#security-question-answer").val() &&
          ($("#forgot-user-name-check-button").prop("disabled", !0),
          $("#forgot-password-security-question-button").prop("disabled", !1),
          $("#security-question-response-status").show(),
          13 == e.which &&
            check_security_question_answer(
              ajax_url,
              "security-question-answer",
              "security-question-response-status",
            )),
          "" == $("#security-question-answer").val() &&
            ($("#forgot-user-name-check-button").prop("disabled", !1),
            $("#forgot-password-security-question-button").prop("disabled", !0),
            $("#security-question-response-status").empty().hide()));
      }),
      $(".password-field").on(
        "keyup change input paste focus blur",
        checkFieldsMatch,
      ));
    var e = { attributes: !0, childList: !0, subtree: !0, characterData: !0 };
    ("use strict");
    ($(".password-field").each(function () {
      new MutationObserver(function (e) {
        checkFieldsMatch();
      }).observe(this, e);
    }),
      (function e() {
        (checkFieldsMatch(), requestAnimationFrame(e));
      })());
    var t = {};
    ((t.ui = {
      container: "#pwd-container",
      showErrors: !0,
      useVerdictCssClass: !0,
      showVerdictsInsideProgressBar: !0,
      viewports: { progress: ".pwd-strength-viewport-progress" },
      progressBarExtraCssClasses: "progress-bar-striped active",
      progressBarEmptyPercentage: 2,
      progressBarMinPercentage: 6,
    }),
      (t.common = {
        zxcvbn: !0,
        minChar: 8,
        onKeyUp: function (e, t) {
          $("#length-help-text").text(
            label_length +
              ": " +
              $(e.target).val().length +
              " | " +
              label_score +
              ": " +
              t.score.toFixed(2),
          );
        },
      }),
      $("#password-entry").pwstrength(t));
  }));
